---
title: "å‹•ã‹ã—ã¦ç†è§£ã™ã‚‹Git | addã¨commitç·¨"
emoji: "ğŸ¤²"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [git]
published: true
---
ã“ã®è¨˜äº‹ã§ã¯ã€Gitã®`add`, `commit` ã‚³ãƒãƒ³ãƒ‰ã«ã¤ã„ã¦æ·±æ˜ã‚Šã—ãŸå†…å®¹ã‚’ã¾ã¨ã‚ã¾ã™ã€‚

## addã‚³ãƒãƒ³ãƒ‰
addã¯é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã‚’ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã§ã™ã€‚
å…·ä½“çš„ã«ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’ã—ã¦ã„ã¾ã™ã€‚
- ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’åœ§ç¸®ã—ã¦Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—`.git/objects/`ã«ä¿å­˜ã€‚
- ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢(`.git/index`)ã«ç™»éŒ²ã€‚

### addã®å†…éƒ¨çš„ãªå‹•ä½œã‚’è¿½ã£ã¦ã¿ã‚‹
#### ä¸‹æº–å‚™
ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã‚’é…ç½®ã—ã€a.txtã«å¤‰æ›´ã‚’åŠ ãˆã¾ã—ãŸã€‚
```
/folder1
â”œâ”€â”€ /folder-1-1
| 	â””â”€â”€ c.txt
â””â”€â”€ b.txt
a.txt // â† ã“ã“ã‚’å¤‰æ›´ãƒ»addã—ã¦ã¿ã‚‹ã€‚
```
```diff: a.txtã®å¤‰æ›´å†…å®¹
Treeãƒ»Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¢ºèªç”¨ã€‚

ã“ã“ã¯`a.txt`ã§ã™ã€‚
+ 
+ ã“ã“ã‚’å¤‰æ›´ã—ã¦ã€addã®æŒ™å‹•ã‚’è¦‹ã¦ã¿ã‚‹ã€‚
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§indexã«ç™»éŒ²ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨ã€ãã®Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒãƒƒã‚·ãƒ¥ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```
git ls-files --stage
```

#### addã—ã¦ã„ãªã„ã¨ãã®index
ã¾ãšã¯ã€addã—ã¦ã„ãªã„çŠ¶æ…‹ã§indexã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

```: ls-filesã®çµæœ
PS C:\Users\...\git-playground> git ls-files --stage
100644 d8038ab201a19d961c0be971a06479e1b857490a 0       a.txt
100644 6b2641653428bc52ebadf30821061fe6b148b039 0       folder1/b.txt
100644 b993a127140d50bab9c349674730d160a264f29a 0       folder1/folder1-1/c.txt
```

`cat-file` ã‚³ãƒãƒ³ãƒ‰ã§a.txtã®ä¸­èº«ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€å¤‰æ›´å‰ã®å†…å®¹ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

```: a.txtã®ä¸­èº«
PS C:\Users\...\git-playground> git cat-file -p d8038ab201a19d961c0be971a06479e1b857490a
Treeãƒ»Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¢ºèªç”¨ã€‚

ã“ã“ã¯`a.txt`ã§ã™ã€‚
```

#### addã—ãŸå¾Œã®index
ä»Šåº¦ã¯ã€`git add a.txt` ã‚’ã—ãŸå¾Œã®indexã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

```diff: ls-filesã®çµæœ
PS C:\Users\...\git-playground> git ls-files --stage
- 100644 d8038ab201a19d961c0be971a06479e1b857490a 0       a.txt
+ 100644 8b36dadad0a62065b636af374e9c8d4c923924cb 0       a.txt
  100644 6b2641653428bc52ebadf30821061fe6b148b039 0       folder1/b.txt
  100644 b993a127140d50bab9c349674730d160a264f29a 0       folder1/folder1-1/c.txt
```

a.txtã®ãƒãƒƒã‚·ãƒ¥ãŒå…ˆã»ã©ã¨å¤‰ã‚ã£ã¦ã„ã‚‹ã®ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
ä¸­èº«ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€å¤‰æ›´å¾Œã®å†…å®¹ã«ãªã£ã¦ã„ã¾ã™ã€‚

```: a.txtã®ä¸­èº«
PS C:\Users\...\git-playground> git cat-file -p  8b36dadad0a62065b636af374e9c8d4c923924cb
Treeãƒ»Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç¢ºèªç”¨ã€‚

ã“ã“ã¯`a.txt`ã§ã™ã€‚

ã“ã“ã‚’å¤‰æ›´ã—ã¦ã€addã®æŒ™å‹•ã‚’è¦‹ã¦ã¿ã‚‹ã€‚
```

add ã‚’ã™ã‚‹ã¨ã€é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ–°ã—ã„Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã€indexã«ä¸Šæ›¸ãã•ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚
add ã—ã¦ã‚‚ã€å¤‰æ›´å‰ã®Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å‰Šé™¤ã•ã‚Œãšã«`.git/objects/`ã«ã‚ã‚Šã€éå»ã®ã‚³ãƒŸãƒƒãƒˆã‹ã‚‰å‚ç…§ã•ã‚Œã¾ã™ã€‚


:::message
**ğŸ¤” addã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ä»¥å¤–ã‚‚ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã®ã¯ãªãœï¼Ÿ**
Gitã¯ã‚³ãƒŸãƒƒãƒˆã”ã¨ã«ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«çŠ¶æ…‹ã€ã‚’ä¸¸ã”ã¨ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚
ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã‚¨ãƒªã‚¢ã¯ã€æ¬¡ã®ã‚³ãƒŸãƒƒãƒˆã«å«ã‚ã‚‹ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«çŠ¶æ…‹ã€ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚
â€» ã‚ã‚‹æ™‚ç‚¹ã§ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã®çŠ¶æ…‹ã®ã“ã¨ã‚’ã€Œã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã€ã¨ã„ã„ã¾ã™ã€‚
:::

## commitã‚³ãƒãƒ³ãƒ‰

ã‚³ãƒŸãƒƒãƒˆã§ã¯æ–°ã—ã„å¤‰æ›´å±¥æ­´ã‚’ä½œæˆã—ã¾ã™ã€‚
å…·ä½“çš„ã«ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’ã—ã¦ã„ã¾ã™ã€‚
- indexã‚’èª­ã¿å–ã‚Šæ–°ã—ãTreeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚
    - ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ä½œæˆãƒ»ç™»éŒ²ã™ã‚‹ã€‚
- Commitã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹ã€‚
- HEADã‚’æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡ã™ã‚ˆã†ã«é€²ã‚ã‚‹ã€‚

### ã‚³ãƒŸãƒƒãƒˆã®å†…éƒ¨çš„ãªå‹•ä½œã‚’è¿½ã£ã¦ã¿ã‚‹
addã‚³ãƒãƒ³ãƒ‰ã®ã¨ãã«ã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã—ãŸå¤‰æ›´ãŒã‚ã‚‹ã®ã§ã€ãã‚Œã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ã¿ã¾ã™ã€‚

#### ä¸‹æº–å‚™
ç¾åœ¨ã¯write-articleãƒ–ãƒ©ãƒ³ãƒã«ã„ã‚‹ã®ã§ã€.git/HEADã®ä¸­èº«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

```:.git/HEAD
ref: refs/heads/write-article
```
#### ã‚³ãƒŸãƒƒãƒˆå‰
write-articleãƒ–ãƒ©ãƒ³ãƒã¯æœ€æ–°ã®ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡ã—ã¦ã„ã¾ã™ã€‚
```:.git/refs/heads/write-article
c175cc4b295c544d3b80662f46cf06383171a191
```

#### ã‚³ãƒŸãƒƒãƒˆå¾Œ
ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒŸãƒƒãƒˆã—ã¦ã¿ã¾ã—ãŸã€‚
```:ã‚³ãƒŸãƒƒãƒˆçµæœ
PS C:\Users\...\git-playground> git commit -m "ã‚³ãƒŸãƒƒãƒˆã—ã¦å‹•ä½œç¢ºèª"
[write-article fda604c] ã‚³ãƒŸãƒƒãƒˆã—ã¦å‹•ä½œç¢ºèª
 1 file changed, 3 insertions(+), 1 deletion(-)
```

ã‚³ãƒŸãƒƒãƒˆå‰å¾Œã®.gitãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¯”è¼ƒã—ã¦ã¿ã‚‹ã¨ã€
ä½•ã‚„ã‚‰æ–°ã—ã2ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã¦ã„ã¾ã—ãŸã€‚ 
![objectsã®æ¯”è¼ƒ](https://raw.githubusercontent.com/makim0939/zenn-content/refs/heads/main/articles/images/git-hands-on-add-commit/winmerge-objects.png)

ç‰‡æ–¹ã¯Commitã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚
```:cat-fileã§è¦‹ãŸçµæœ
PS C:\Users\...\git-playground> git cat-file -p fda604c66974a2eb6352141305481eb268700996
tree fcfd7cb8d9db0f93c35aae39692800d13eb320af
parent c175cc4b295c544d3b80662f46cf06383171a191
author makim0939 <makim0939@gmail.com> 1757245797 +0900
committer makim0939 <makim0939@gmail.com> 1757245797 +0900

ã‚³ãƒŸãƒƒãƒˆã—ã¦å‹•ä½œç¢ºèª
```

ã‚‚ã†ç‰‡æ–¹ã¯Treeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚
```:cat-fileã§è¦‹ãŸçµæœ
PS C:\Users\...\git-playground> git cat-file -p fcfd7cb8d9db0f93c35aae39692800d13eb320af
100644 blob 8b36dadad0a62065b636af374e9c8d4c923924cb    a.txt
040000 tree d8b465f99cbd8047e700b7a5843dccaf685efb77    folder1
```

write-articleãƒ–ãƒ©ãƒ³ãƒãŒæ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡ã™ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

```:.git/refs/heads/write-article
fda604c66974a2eb6352141305481eb268700996
```

.git/logsã®ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒã«ã€æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

![logsæ¯”è¼ƒ](https://raw.githubusercontent.com/makim0939/zenn-content/refs/heads/main/articles/images/git-hands-on-add-commit/winmerge-logs.png)

ä¸­èº«ã¯è¦‹ã‚Œãªã„ã§ã™ãŒã€.git/indexã‚‚æ›¸ãæ›ã‚ã£ã¦ã„ã¾ã—ãŸã€‚

![indexæ¯”è¼ƒ](https://raw.githubusercontent.com/makim0939/zenn-content/refs/heads/main/articles/images/git-hands-on-add-commit/winmerge-index.png)


- ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã¨ã€æ–°ã—ãTreeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã€ã“ã®æ™‚ç‚¹ã§ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒè¨˜éŒ²ã•ã‚Œã‚‹ã€‚
- ãã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ(ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®Treeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)ã‚’ã‚‚ã¤Commitã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ–°ã—ãä½œæˆã•ã‚Œã‚‹ã€‚
- HEADãŒæŒ‡ã™ãƒ–ãƒ©ãƒ³ãƒ(ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒ)ãŒæŒ‡ã™å…ˆãŒä»Šå›ã®ã‚³ãƒŸãƒƒãƒˆã«å¤‰æ›´ã•ã‚Œã‚‹ã€‚
- logsã«ã‚³ãƒŸãƒƒãƒˆã®æƒ…å ±ãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚
- indexã§ãŠãã‚‰ãã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã®æƒ…å ±ãŒæ›´æ–°ã•ã‚Œã‚‹ã€‚